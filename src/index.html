<!DOCTYPE html>
<html lang="en">
<head>
  <title>Rock Buddy</title>
</head>
<body>
  <p>Loading...</p>
  <script src="common/functions.js"></script>
  <script>
    'use strict';
    sessionUpdate();
    
    async function main() {
      const auth = await checkAuthentication()
      if(!auth) {
        // Authentication failed - navigate to login
        window.location.href = './auth/login.html';
        return;
      }

      // Verify the user's email
      const authData = JSON.parse(sessionStorage.getItem('auth_data'));
      const activated = await checkAccountActivation(authData);
      if (!activated) {
        // Verification failed - redirect to account activation
        window.location.href = './account/activation.html'
        return; 
      }

      // Authentication successful - proceed
      window.location.href = './sniffer/sniffer.html';
      return;
    }

    main();
  </script>
</body>
</html>